<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Wykaz Oddawczy v3.0</title>
    <style>
        /* --- STYLE OG√ìLNE --- */
        :root {
            --print-font: 'Arial', sans-serif;
            --primary-color: #003366; /* Kolejowy granat */
            --secondary-color: #f4f6f9;
            --pen-color: #0044cc; /* Niebieski d≈Çugopis */
            --danger-color: #cc0000; /* Czerwony dla Orygina≈Çu */
            --border-color: #dde2e9;
        }
        
        body { margin: 0; padding: 0; font-family: var(--print-font); background: #e9ecef; color: #333; }
        
        /* --- UI EDYCJI (EKRAN) --- */
        .screen-ui {
            max-width: 1050px;
            margin: 30px auto;
            padding-bottom: 60px;
        }

        .app-header { text-align: center; margin-bottom: 30px; }
        .app-header h2 { color: var(--primary-color); margin: 0; font-size: 28px; text-transform: uppercase; letter-spacing: 1px; font-weight: 800; }
        .app-header p { color: #666; font-size: 14px; margin-top: 5px; }

        /* KARTY */
        .section-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 25px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .section-header {
            background: var(--primary-color);
            color: white;
            padding: 12px 20px;
            font-size: 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-body { padding: 25px; }

        /* DASHBOARD GRID */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
        }

        .input-group-styled {
            background: var(--secondary-color);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            transition: border-color 0.3s;
        }
        .input-group-styled:focus-within {
            border-color: var(--pen-color);
            box-shadow: 0 0 0 3px rgba(0, 68, 204, 0.1);
        }

        .input-label {
            font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px;
            color: #666; font-weight: bold; margin-bottom: 8px;
        }

        .input-control {
            border: none; background: transparent; font-size: 16px; font-weight: 600;
            color: var(--pen-color); width: 100%; outline: none; padding: 0;
        }
        .input-control::placeholder { color: #bbb; font-weight: normal; }

        .date-row { display: flex; align-items: center; justify-content: space-between; }
        .btn-mini {
            background: #e1e4e8; color: #333; border: none;
            padding: 4px 10px; border-radius: 4px; font-size: 11px;
            cursor: pointer; font-weight: bold;
        }
        .btn-mini:hover { background: #d0d4da; }

        /* TABELA EDYCJI */
        table.input-table { width: 100%; border-collapse: collapse; border: 2px solid #333; }
        table.input-table th { background: #f0f0f0; padding: 12px; font-size: 12px; border: 1px solid #333; color: #000; text-transform: uppercase; }
        table.input-table td { padding: 0; border: 1px solid #333; background: #fff; }
        
        table.input-table input { 
            width: 100%; border: none; padding: 10px 5px; 
            margin: 0; font-size: 14px; text-align: center; outline: none; background: transparent;
            color: var(--pen-color); font-weight: 600; box-sizing: border-box; 
        }
        table.input-table input:focus { background: #fffbe6; }
        table.input-table input.align-left { text-align: left; padding-left: 8px; }

        /* PASEK AKCJI */
        .action-bar {
            background: #fff; padding: 15px 25px; border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: sticky; bottom: 20px; border: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center;
        }

        .copy-control {
            display: flex; align-items: center; gap: 15px;
            background: var(--secondary-color); padding: 8px 15px; border-radius: 6px; border: 1px solid var(--border-color);
        }
        .total-badge {
            background: var(--primary-color); color: white;
            padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold;
        }
        
        .btn { padding: 12px 28px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 15px; transition: all 0.2s; display: flex; align-items: center; gap: 8px; }
        .btn-print { background: var(--primary-color); color: white; box-shadow: 0 4px 10px rgba(0,51,102,0.2); }
        .btn-print:hover { background: #002e5c; transform: translateY(-1px); }
        .btn-reset { background: white; color: var(--danger-color); border: 1px solid #ffcccc; }
        .btn-reset:hover { background: #fff5f5; border-color: var(--danger-color); }

        #saveStatus { font-size: 12px; color: green; opacity: 0; transition: opacity 0.5s; margin-right: 15px; font-weight: bold;}

        /* --- UI WYDRUKU --- */
        @media print {
            .screen-ui { display: none !important; }
            body { background: white; margin: 0; }
            @page { size: A4; margin: 1cm; }
            .blue-ink { color: #0044cc !important; font-weight: bold; }
        }

        .print-area { display: none; }
        @media print { .print-area { display: block; } }

        .page-a4 {
            width: 100%; height: 270mm; 
            display: flex; flex-direction: column; justify-content: space-between; 
            page-break-after: always;
        }
        .page-a4:last-child { page-break-after: auto; }

        .form-half { height: 48%; width: 100%; position: relative; display: flex; flex-direction: column; }

        /* UK≈ÅAD TABELI WYDRUKU */
        table.header-table { width: 100%; border-collapse: collapse; font-size: 11px; margin-bottom: 5px; }
        .h-col-left { width: 25%; vertical-align: top; }
        .h-col-center { width: 50%; vertical-align: top; text-align: center; }
        .h-col-right { width: 25%; vertical-align: top; padding-left: 10px; }
        .stamp-box { height: 60px; width: 100px; display: flex; align-items: center; justify-content: center; color: #ccc; font-size: 9px; }
        .main-title { font-size: 16pt; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-top: 15px; }
        .sub-title { font-size: 10pt; margin-bottom: 10px; }
        .conductor-label { font-size: 9px; margin-bottom: 2px; }
        .conductor-val { border-bottom: 1px dotted #000; font-weight: bold; min-height: 14px; margin-bottom: 8px; }

        table.train-table { width: 100%; border-collapse: collapse; margin-top: 5px; font-size: 11px; }
        table.train-table td { padding: 2px; white-space: nowrap; }
        .val-line { border-bottom: 1px dotted #000; font-weight: bold; text-align: center; padding: 0 5px; min-height: 14px; }

        table.list-table { width: 100%; border-collapse: collapse; font-size: 10px; margin-top: 5px; table-layout: fixed; }
        table.list-table th { border: 1px solid #000; padding: 3px; font-weight: normal; text-align: center; vertical-align: middle; }
        table.list-table td { 
            border: 1px solid #000; height: 18px; padding: 0 2px; 
            vertical-align: middle; text-align: center; overflow: hidden; 
            white-space: normal; line-height: 1; word-wrap: break-word;
        }
        
        .cell-print-remarks { font-size: 8px; text-align: left; vertical-align: middle; }
        .cell-print-station { font-size: 9px; line-height: 0.9; }

        /* ZMIANA v3.0: Styl sekcji sumowania (poza tabelƒÖ) */
        .summary-bar {
            width: 100%;
            display: flex;
            font-size: 9px;
            margin-top: 2px;
            /* Flexbox udajƒÖcy kolumny tabeli: 20+20+10+10 = 60% lewej strony */
        }
        .sum-label {
            width: 60%; /* Odpowiada kolumnom Stacje + Rodzaj + Nr */
            text-align: right;
            padding-right: 5px;
            font-weight: bold;
            box-sizing: border-box;
        }
        .sum-val-szt {
            width: 8%; /* Odpowiada kolumnie Szt */
            text-align: center;
            font-weight: bold;
            border-bottom: 1px solid #000; /* Opcjonalne podkre≈õlenie sumy */
        }
        .sum-val-masa {
            width: 8%; /* Odpowiada kolumnie Masa */
            text-align: center;
            font-weight: bold;
            border-bottom: 1px solid #000;
        }
        .sum-empty {
            width: 24%; /* Odpowiada kolumnie Uwagi */
        }

        .form-footer { display: flex; justify-content: space-between; align-items: flex-end; margin-top: auto; padding-bottom: 5px; }
        
        .sign-placeholder { 
            border-bottom: 1px dotted #000; 
            width: 150px; 
            margin-top: 30px;
            display: flex; align-items: flex-end; justify-content: center;
            padding-bottom: 2px; min-height: 20px; font-size: 12px;
        }
        
        /* ZMIANA v3.0: Kolory etykiet */
        .label-original { color: #cc0000; font-weight: bold; font-size: 14px; width: 100px; }
        .label-copy { color: #000000; font-weight: bold; font-size: 14px; width: 100px; }
        
        .cut-line { width: 100%; border-bottom: 1px dashed #999; height: 0; margin: auto 0; }
    </style>
</head>
<body>

<datalist id="stations-list"></datalist>

<div class="screen-ui">
    
    <div class="app-header">
        <h2>Generator Wykazu Oddawczego</h2>
    </div>
    
    <form id="mainForm">
        
        <div class="section-card">
            <div class="section-header">
                <span>DANE NAG≈Å√ìWKOWE</span>
                <span style="font-size: 11px; opacity: 0.8;">UZUPE≈ÅNIJ POLA PONI≈ªEJ</span>
            </div>
            <div class="section-body">
                <div class="dashboard-grid">
                    
                    <div class="input-group-styled">
                        <label class="input-label">Do pociƒÖgu nr</label>
                        <input type="text" id="in_t_to" class="input-control" placeholder="np. 1814">
                    </div>

                    <div class="input-group-styled">
                        <label class="input-label">Data</label>
                        <div class="date-row">
                            <input type="date" id="in_d_to" class="input-control">
                            <button type="button" class="btn-mini" onclick="setToday()">DZI≈ö</button>
                        </div>
                    </div>

                    <div class="input-group-styled">
                        <label class="input-label">Zda≈Ç (Imiƒô i Nazwisko)</label>
                        <input type="text" id="in_handed_by" class="input-control" placeholder="Wpisz nazwisko...">
                    </div>

                </div>
            </div>
        </div>

        <div class="section-card">
            <div class="section-header">
                <span>LISTA PRZESY≈ÅEK</span>
                <button type="button" class="btn-mini" style="color: #333;" onclick="clearRows()">WYCZY≈öƒÜ TABELƒò</button>
            </div>
            <div class="section-body" style="padding: 0;">
                <div id="tableContainer"></div>
            </div>
        </div>

        <div class="action-bar">
            <button type="button" class="btn btn-reset" onclick="resetAll()">
                <span>üóëÔ∏è</span> Reset
            </button>

            <div style="display: flex; align-items: center; gap: 20px;">
                <span id="saveStatus">Zapisano ‚úì</span>
                
                <div class="copy-control">
                    <div>
                        <div style="font-size: 10px; color: #666; font-weight: bold; text-transform: uppercase;">Kopie dodatkowe</div>
                        <input type="number" id="in_copies" value="3" min="1" style="width: 50px; border: 1px solid #ccc; border-radius: 4px; padding: 4px; font-weight: bold; color: black;" onchange="updateTotalCount()" onkeyup="updateTotalCount()">
                    </div>
                    <div style="border-left: 1px solid #ccc; padding-left: 15px;">
                        <span id="total-badge" class="total-badge">≈ÅƒÖcznie: 4 szt.</span>
                    </div>
                </div>
                
                <button type="button" class="btn btn-print" onclick="generatePrint()">
                    <span>üñ®Ô∏è</span> DRUKUJ DOKUMENTY
                </button>
            </div>
        </div>

    </form>
    
    <div style="text-align: center; margin-top: 20px; font-size: 11px; color: #aaa;">
        Wsp√≥≈Çautorzy: Gemini, Piotr M üöÇ
    </div>
</div>

<div id="printOutput" class="print-area"></div>

<script>
    const ROWS_COUNT = 10; 
    const STORAGE_KEY = 'wykaz_oddawczy_v2_data';
    const STATIONS_FILE = 'stacje.json';

    const FALLBACK_STATIONS = [
        "Bia≈Çystok", "Bydgoszcz G≈Ç√≥wna", "E≈Çk", "Gda≈Ñsk G≈Ç√≥wny", "Gda≈Ñsk Wrzeszcz",
        "Gdynia G≈Ç√≥wna", "Katowice", "Ko≈Çobrzeg", "Krak√≥w G≈Ç√≥wny", "Kutno",
        "Lublin G≈Ç√≥wny", "≈Å√≥d≈∫ Fabryczna", "≈Å√≥d≈∫ Kaliska", "≈Å√≥d≈∫ Widzew",
        "Pozna≈Ñ G≈Ç√≥wny", "Rzesz√≥w G≈Ç√≥wny", "Szczecin G≈Ç√≥wny", "Terespol",
        "Warszawa Centralna", "Warszawa Gda≈Ñska", "Warszawa Groch√≥w",
        "Warszawa Wschodnia", "Warszawa Zachodnia", "Wroc≈Çaw G≈Ç√≥wny"
    ];

    window.addEventListener('DOMContentLoaded', () => {
        loadStations();
        renderInputTable();
        loadFromStorage();
        setupAutoSave();
        setupAutoFillLogic();
        updateTotalCount();
    });

    function updateTotalCount() {
        const input = document.getElementById('in_copies');
        let extras = parseInt(input.value);
        if (isNaN(extras) || extras < 0) extras = 0;
        const total = 1 + extras;
        document.getElementById('total-badge').innerText = `≈ÅƒÖcznie: ${total} szt.`;
    }

    function loadStations() {
        const datalist = document.getElementById('stations-list');
        fetch(STATIONS_FILE)
            .then(response => { if (!response.ok) throw new Error("Err"); return response.json(); })
            .then(data => populateDatalist(datalist, data))
            .catch(error => populateDatalist(datalist, FALLBACK_STATIONS));
    }
    function populateDatalist(element, stations) {
        element.innerHTML = '';
        stations.forEach(station => {
            const option = document.createElement('option');
            option.value = station;
            element.appendChild(option);
        });
    }

    function setupAutoFillLogic() {
        const table = document.getElementById('gridTable');
        table.addEventListener('input', function(e) {
            const triggerClasses = ['cell-rodz', 'cell-nr', 'cell-szt', 'cell-masa', 'cell-uwagi'];
            const isTrigger = triggerClasses.some(cls => e.target.classList.contains(cls));

            if (isTrigger) {
                const currentRow = e.target.closest('tr');
                const rows = Array.from(currentRow.closest('tbody').querySelectorAll('tr'));
                const rowIndex = rows.indexOf(currentRow);

                if (rowIndex > 0) {
                    const firstRow = rows[0];
                    const nad0 = firstRow.querySelector('.cell-nad').value;
                    const prz0 = firstRow.querySelector('.cell-prz').value;
                    const currentNad = currentRow.querySelector('.cell-nad');
                    const currentPrz = currentRow.querySelector('.cell-prz');

                    if (currentNad.value.trim() === '') currentNad.value = nad0;
                    if (currentPrz.value.trim() === '') currentPrz.value = prz0;
                    saveToStorage();
                }
            }
        });
    }

    function setToday() {
        document.getElementById('in_d_to').value = new Date().toISOString().split('T')[0];
        saveToStorage(); 
    }

    function renderInputTable() {
        const container = document.getElementById('tableContainer');
        let html = `
        <table class="input-table" id="gridTable">
            <thead>
                <tr>
                    <th width="20%">Stacja Nadania</th>
                    <th width="20%">Stacja Przezn.</th>
                    <th width="10%">Rodzaj</th>
                    <th width="10%">Nr dok.</th>
                    <th width="8%">Szt.</th>
                    <th width="8%">Masa</th>
                    <th>Uwagi</th>
                </tr>
            </thead>
            <tbody>`;
        for(let i=0; i<ROWS_COUNT; i++) {
            html += `
                <tr>
                    <td><input class="cell-nad" list="stations-list"></td>
                    <td><input class="cell-prz" list="stations-list"></td>
                    <td><input class="cell-rodz"></td>
                    <td><input class="cell-nr"></td>
                    <td><input class="cell-szt"></td>
                    <td><input class="cell-masa"></td>
                    <td><input class="cell-uwagi align-left"></td>
                </tr>`;
        }
        html += `</tbody></table>`;
        container.innerHTML = html;
    }

    function saveToStorage() {
        const data = collectData();
        data.copies = document.getElementById('in_copies').value;
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        const status = document.getElementById('saveStatus');
        status.style.opacity = '1';
        setTimeout(() => { status.style.opacity = '0'; }, 2000);
    }

    function loadFromStorage() {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) { setToday(); return; }
        try {
            const data = JSON.parse(raw);
            document.getElementById('in_t_to').value = data.trainTo || '';
            document.getElementById('in_d_to').value = data.dateTo || new Date().toISOString().split('T')[0];
            // ZMIANA v3.0: Domy≈õlnie 3 kopie je≈õli brak danych
            document.getElementById('in_copies').value = (data.copies !== undefined) ? data.copies : 3;
            document.getElementById('in_handed_by').value = data.handedBy || '';

            const trs = document.querySelectorAll('#gridTable tbody tr');
            if (data.rows && data.rows.length > 0) {
                data.rows.forEach((rowData, index) => {
                    if (index < trs.length) {
                        const tr = trs[index];
                        tr.querySelector('.cell-nad').value = rowData.nad || '';
                        tr.querySelector('.cell-prz').value = rowData.prz || '';
                        tr.querySelector('.cell-rodz').value = rowData.rodz || '';
                        tr.querySelector('.cell-nr').value = rowData.nr || '';
                        tr.querySelector('.cell-szt').value = rowData.szt || '';
                        tr.querySelector('.cell-masa').value = rowData.masa || '';
                        tr.querySelector('.cell-uwagi').value = rowData.uwagi || '';
                    }
                });
            }
            updateTotalCount(); 
        } catch (e) { console.error(e); }
    }

    function setupAutoSave() {
        document.getElementById('mainForm').addEventListener('input', saveToStorage);
    }

    function resetAll() {
        if (confirm("Czy wyczy≈õciƒá formularz?")) {
            localStorage.removeItem(STORAGE_KEY);
            location.reload();
        }
    }

    function clearRows() {
        document.querySelectorAll('#gridTable input').forEach(inp => inp.value = '');
        saveToStorage();
    }

    function collectData() {
        const rows = [];
        const trs = document.querySelectorAll('#gridTable tbody tr');
        trs.forEach(tr => {
            rows.push({
                nad: tr.querySelector('.cell-nad').value,
                prz: tr.querySelector('.cell-prz').value,
                rodz: tr.querySelector('.cell-rodz').value,
                nr: tr.querySelector('.cell-nr').value,
                szt: tr.querySelector('.cell-szt').value,
                masa: tr.querySelector('.cell-masa').value,
                uwagi: tr.querySelector('.cell-uwagi').value
            });
        });
        return {
            trainTo: document.getElementById('in_t_to').value,
            dateTo: document.getElementById('in_d_to').value,
            handedBy: document.getElementById('in_handed_by').value,
            rows: rows
        };
    }

    function getSheetHTML(data, type) {
        const filledRows = data.rows.filter(r => r.nad.trim() !== '' || r.prz.trim() !== '');
        const posCount = filledRows.length;
        const piecesSum = data.rows.reduce((sum, r) => sum + (parseInt(r.szt) || 0), 0);
        const massSum = data.rows.reduce((sum, r) => sum + (parseFloat(r.masa.replace(',','.')) || 0), 0);
        const massDisplay = massSum > 0 ? massSum.toFixed(1) : '';

        // Ustalenie klasy koloru dla etykiety Orygina≈Ç/Kopia
        const labelClass = (type === 'ORYGINA≈Å') ? 'label-original' : 'label-copy';

        const rowsHTML = data.rows.map(r => `
            <tr>
                <td class="blue-ink cell-print-station">${r.nad}</td>
                <td class="blue-ink cell-print-station">${r.prz}</td>
                <td class="blue-ink">${r.rodz}</td>
                <td class="blue-ink">${r.nr}</td>
                <td class="blue-ink">${r.szt}</td>
                <td class="blue-ink">${r.masa}</td>
                <td class="blue-ink cell-print-remarks">${r.uwagi}</td>
            </tr>
        `).join('');

        return `
        <div class="form-half">
            <table class="header-table">
                <tr>
                    <td class="h-col-left"><div class="stamp-box">(stempel wystawcy)</div></td>
                    <td class="h-col-center">
                        <div class="main-title">WYKAZ ODDAWCZY</div>
                        <div class="sub-title">na przesy≈Çki oddane</div>
                    </td>
                    <td class="h-col-right">
                        <div class="conductor-label">Nazwisko konduktora oddajƒÖcego</div>
                        <div class="conductor-val"></div>
                        <div class="conductor-label">i jego stacja macierzysta</div>
                        <div class="conductor-val"></div>
                    </td>
                </tr>
            </table>
            <table class="train-table">
                <tr>
                    <td style="width: 80px;">do poc. nr</td>
                    <td class="val-line blue-ink" style="width: 100px;">${data.trainTo}</td>
                    <td style="width: 40px; text-align: right;">dnia</td>
                    <td class="val-line blue-ink" style="width: 100px;">${data.dateTo}</td>
                    <td></td>
                </tr>
                <tr style="height: 5px;"><td colspan="5"></td></tr>
                <tr>
                    <td style="width: 80px;">z poc. nr</td>
                    <td class="val-line" style="width: 100px;"></td>
                    <td style="width: 40px; text-align: right;">dnia</td>
                    <td class="val-line" style="width: 100px;"></td>
                    <td style="width: 60px; text-align: right;">na stacji</td>
                    <td class="val-line" style="width: 150px;"></td>
                </tr>
            </table>
            
            <table class="list-table">
                <colgroup>
                    <col style="width: 20%"><col style="width: 20%">
                    <col style="width: 10%"><col style="width: 10%">
                    <col style="width: 8%"><col style="width: 8%">
                    <col style="width: 24%">
                </colgroup>
                <thead>
                    <tr>
                        <th colspan="2">STACJA</th>
                        <th colspan="2">Dokument przewozowy</th>
                        <th rowspan="2">Liczba<br>sztuk</th>
                        <th rowspan="2">Masa<br>kg</th>
                        <th rowspan="2">Uwagi (nr wagonu,<br>dok. celnych itp.)</th>
                    </tr>
                    <tr>
                        <th>Nadania</th>
                        <th>Przeznaczenia</th>
                        <th>rodzaj</th>
                        <th>nr</th>
                    </tr>
                </thead>
                <tbody>
                    ${rowsHTML}
                </tbody>
            </table>
            
            <div class="summary-bar">
                <div class="sum-label">OG√ì≈ÅEM (pozycji: ${posCount}):</div>
                <div class="sum-val-szt blue-ink">${piecesSum}</div>
                <div class="sum-val-masa blue-ink">${massDisplay}</div>
                <div class="sum-empty"></div>
            </div>

            <div class="form-footer">
                <div class="${labelClass}">${type}</div>
                
                <div style="text-align:center;">
                    <div style="font-size:10px;">ZDA≈Å:</div>
                    <div class="sign-placeholder blue-ink">${data.handedBy}</div>
                </div>
                <div style="text-align:center;">
                    <div style="font-size:10px;">PRZYJƒÑ≈Å:</div>
                    <div class="sign-placeholder"></div>
                </div>
            </div>
        </div>
        `;
    }

    function generatePrint() {
        saveToStorage(); 
        const data = collectData();
        const container = document.getElementById('printOutput');
        container.innerHTML = '';

        const copiesInput = parseInt(document.getElementById('in_copies').value) || 0;
        const totalForms = 1 + copiesInput;
        const totalPages = Math.ceil(totalForms / 2);

        let generatedCount = 0;
        for (let i = 0; i < totalPages; i++) {
            const pageDiv = document.createElement('div');
            pageDiv.className = 'page-a4';
            if (generatedCount < totalForms) {
                const type = (generatedCount === 0) ? 'ORYGINA≈Å' : 'KOPIA';
                pageDiv.innerHTML += getSheetHTML(data, type);
                generatedCount++;
            }
            if (generatedCount < totalForms && generatedCount % 2 !== 0) { 
               pageDiv.innerHTML += '<div class="cut-line"></div>';
            }
            if (generatedCount < totalForms) {
                pageDiv.innerHTML += getSheetHTML(data, 'KOPIA');
                generatedCount++;
            }
            container.appendChild(pageDiv);
        }
        window.print();
    }
</script>

</body>
</html>